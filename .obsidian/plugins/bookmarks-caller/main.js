/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var V=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var X=Object.getOwnPropertyNames;var Z=Object.prototype.hasOwnProperty;var ee=(i,a)=>{for(var e in a)V(i,e,{get:a[e],enumerable:!0})},te=(i,a,e,s)=>{if(a&&typeof a=="object"||typeof a=="function")for(let t of X(a))!Z.call(i,t)&&t!==e&&V(i,t,{get:()=>a[t],enumerable:!(s=J(a,t))||s.enumerable});return i};var se=i=>te(V({},"__esModule",{value:!0}),i);var de={};ee(de,{default:()=>R});module.exports=se(de);var Q=require("obsidian");var l=require("obsidian");var b=require("obsidian"),oe="empty",N="bookmarks-caller-styles",p=(i,a)=>{var e;return((e=i==null?void 0:i.internalPlugins)==null?void 0:e.getEnabledPluginById(a))||null},I=i=>{switch(i.type){case"group":return"chevron-right";case"folder":return"folder-closed";case"file":return i.subpath?i.subpath.slice(0,2)==="#^"?"toy-brick":"heading":"file";case"search":return"search";case"graph":return"git-fork";default:return""}},E=(i,a)=>{var e,s;if(a.title)return a.title;switch(a.type){case"folder":return(e=a.path)!=null?e:"";case"file":{let t=i.vault.getAbstractFileByPath(a.path||"");return t instanceof b.TFile?t.basename:""}case"search":return(s=a.query)!=null?s:"";case"group":case"graph":default:return""}},C=(i,a)=>{let e=i.vault.getAbstractFileByPath(a.path||"");e instanceof b.TFile&&i.workspace.getLeaf(!0).openFile(e,{eState:{subpath:a.subpath}})},P=(i,a,e)=>{var t;let s=i.vault.getAbstractFileByPath((t=a.path)!=null?t:"");s instanceof b.TFolder&&e&&e.revealInFolder(s)},L=(i,a)=>{var e;a&&a.openGlobalSearch((e=i.query)!=null?e:"")},x=async(i,a,e,s)=>{s&&e&&(await i.workspace.getLeaf(!0).setViewState({type:oe,active:!0}),await e.openBookmark(a,"tab"))},S=async(i,a,e)=>{let s=e?a:a.filter(t=>t.type==="file");for(let t of s)switch(t.type){case"group":await S(i,t.items||[],e);break;case"file":{let o=i.vault.getAbstractFileByPath(t.path||"");o instanceof b.TFile&&await i.workspace.getLeaf(!0).openFile(o,{eState:{subpath:t.subpath}});break}case"folder":case"search":case"graph":default:break}},$=()=>{let i=document.getElementById(N);i&&document.getElementsByTagName("HEAD")[0].removeChild(i)},Y=i=>{let a=document.createElement("style");ne(a,{type:"text/css",id:N}),document.getElementsByTagName("HEAD")[0].appendChild(a),i.forEach(({selector:s,property:t,value:o})=>{ae(s,`${t}: ${o}`,a)})},ne=(i,a)=>{for(let e in a)i.setAttribute(e,a[e])},ae=(i,a,e)=>{e.textContent+=i+`{${a}}`};var k={openBookmarksCaller:"openBookmarksCaller",searchBookmarks:"searchBookmarks"},ie={recursivelyOpen:!0,showFooterButtons:!0,showLegends:!0,focusColor:"#00b4e0",characters:"asdfghjkl;",allBtn:"/",backBtn:"Backspace"},re={structureType:"flat",sortOrder:"original",recursivelyOpen:!0,showFooterButtons:!0,showLegends:!0,focusColor:"#00b4e0"},d={[k.openBookmarksCaller]:ie,[k.searchBookmarks]:re},H={flat:"flat",original:"original"},A={original:"original",newer:"newer",older:"older"},T={min:4,max:10},O=5e3,U="Can't assign duplicate characters and shortcut keys.",le="4 to 10 characters are required.",ce="The key can't be assigned because it's used preferentially by this plugin.",he=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," ","Enter"],D=class extends l.PluginSettingTab{constructor(e,s){super(e,s);this.isOpen={firstDetails:!1,secondDetails:!1};this.plugin=s}display(){let{containerEl:e}=this;e.empty(),e.addClass("bc-settings");{let s=e.createEl("details","",t=>{t.createEl("summary","",o=>{o.setText('For "Open bookmarks caller" command')})});this.isOpen.firstDetails&&s.setAttr("open",!0),s.addEventListener("toggle",()=>this.isOpen.firstDetails=s.open),this.setForOpenBookmarksCallerCommand(s)}{let s=e.createEl("details","",t=>{t.createEl("summary","",o=>{o.setText('For "Search bookmarks" command')})});this.isOpen.secondDetails&&s.setAttr("open",!0),s.addEventListener("toggle",()=>this.isOpen.secondDetails=s.open),this.setForSearchBookmarksCommand(s)}}updateStyleSheet(e=!1){if($(),e)return;let{openBookmarksCaller:s,searchBookmarks:t}=this.plugin.settings,{characters:o,focusColor:n}=s,{focusColor:r}=t;Y([{selector:".bc-buttons-view",property:"min-height",value:`${32*o.length+8*(o.length-1)}px`},{selector:".bc-leaf-name-btn:focus",property:"outline",value:`2px solid ${n}`},{selector:".bookmarks-search-modal .suggestion-item.is-selected",property:"outline",value:`2px solid ${r}`}])}setForOpenBookmarksCallerCommand(e){let s=k.openBookmarksCaller,t=this.plugin.settings[s];new l.Setting(e).setName("Recursively open files under groups").setDesc("When enabled, recursively open files under groups when selected \u201CAll\u201D button.").addToggle(o=>o.setValue(t.recursivelyOpen).onChange(async n=>{t.recursivelyOpen=n,await this.plugin.saveData(this.plugin.settings)})),new l.Setting(e).setName("Show footer buttons").setDesc("When enabled, show footer buttons on modal.").addToggle(o=>o.setValue(t.showFooterButtons).onChange(async n=>{t.showFooterButtons=n,await this.plugin.saveData(this.plugin.settings)})),new l.Setting(e).setName("Show legends").setDesc("When enabled, show legends on modal.").addToggle(o=>o.setValue(t.showLegends).onChange(async n=>{t.showLegends=n,await this.plugin.saveData(this.plugin.settings)})),new l.Setting(e).setName("Color of button frame on focus").setDesc("Choice your favorite color.").addColorPicker(o=>o.setValue(t.focusColor).onChange(async n=>{t.focusColor=n,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(o=>{let n=()=>t.focusColor=d[s].focusColor;this.addResetButton(o,n)}),new l.Setting(e).setName("Characters used for button hints").setDesc(`Enter ${T.min}~${T.max} non-duplicate alphanumeric characters or symbols.`).addText(o=>{let n=t.characters,{allBtn:r,backBtn:h}=t,c=o.setPlaceholder("Enter characters").setValue(t.characters).onChange(async g=>{let{inputEl:v}=c;!this.isDuplicateChars([...g,r,h])&&v.validity.valid?(v.removeClass("bc-setting-is-invalid"),t.characters=g,n=g,await this.plugin.saveSettings()):v.addClass("bc-setting-is-invalid"),this.updateStyleSheet()});return c.inputEl.addEventListener("blur",()=>{this.isDuplicateChars([...c.inputEl.value,r,h])&&(t.characters=n,new l.Notice(U,O)),c.inputEl.validity.valid||(t.characters=n,new l.Notice(le,O))}),c.inputEl.setAttrs({maxLength:T.max,required:!0,pattern:`[!-~]{${T.min},${T.max}}`}),c}).then(o=>{let n=()=>t.characters=d[s].characters;this.addResetButton(o,n)}),new l.Setting(e).setName("Shortcut key for the \u201CAll\u201D button").setDesc("Assign shortcut key for the \u201CAll\u201D button.").addText(o=>(this.allBtnText=o.setValue(t.allBtn),this.allBtnText.inputEl.setAttr("readonly",""),this.allBtnText.inputEl.addClass("bc-setting-shortcut-key"),this.allBtnText)).then(o=>{let n=()=>t.allBtn=d[s].allBtn;this.addResetButton(o,n)}).addExtraButton(o=>o.setIcon("pencil").setTooltip("Custom shortcut key").onClick(()=>{let n=[...t.characters,t.backBtn];this.onClickShortcutKeyEdit(this.allBtnText,"allBtn",n)})),new l.Setting(e).setName("Shortcut key for the \u201CBack\u201D button").setDesc("Assign shortcut key for the \u201CBack\u201D button.").addText(o=>(this.backBtnText=o.setValue(t.backBtn),this.backBtnText.inputEl.setAttr("readonly",""),this.backBtnText.inputEl.addClass("bc-setting-shortcut-key"),this.backBtnText)).then(o=>{let n=()=>t.backBtn=d[s].backBtn;this.addResetButton(o,n)}).addExtraButton(o=>o.setIcon("pencil").setTooltip("Custom shortcut key").onClick(()=>{let n=[...t.characters,t.backBtn];this.onClickShortcutKeyEdit(this.backBtnText,"backBtn",n)}))}setForSearchBookmarksCommand(e){let s=k.searchBookmarks,t=this.plugin.settings[s];new l.Setting(e).setName("Type of structure in the list view").setDesc('"flat" displays nested groups in a flattened structure. \u201Coriginal" displays the structure as defined in the Bookmarks core plugin.').addDropdown(o=>o.addOptions(H).setValue(t.structureType).onChange(async n=>{t.structureType=n,await this.plugin.saveData(this.plugin.settings),this.display()})).then(o=>{let n=()=>t.structureType=d[s].structureType;this.addResetButton(o,n)}),new l.Setting(e).setName("Sort order").setDesc(`
				"original" is displayed in the order defined by the Bookmarks core plugin. 
				"newer" is displayed in order of newer bookmark's creation time. 
				\u201Colder\u201D is displayed in order of older bookmark's creation time.
			`).addDropdown(o=>o.addOptions(A).setValue(t.sortOrder).onChange(async n=>{t.sortOrder=n,await this.plugin.saveData(this.plugin.settings),this.display()})).then(o=>{let n=()=>t.sortOrder=d[s].sortOrder;this.addResetButton(o,n)}),new l.Setting(e).setName("Recursively open files under groups").setDesc("When enabled, recursively open files under groups when selected \u201CAll\u201D button.").addToggle(o=>o.setValue(t.recursivelyOpen).onChange(async n=>{t.recursivelyOpen=n,await this.plugin.saveData(this.plugin.settings)})),new l.Setting(e).setName("Show footer buttons").setDesc("When enabled, show footer buttons on modal.").addToggle(o=>o.setValue(t.showFooterButtons).onChange(async n=>{t.showFooterButtons=n,await this.plugin.saveData(this.plugin.settings)})),new l.Setting(e).setName("Show legends").setDesc("When enabled, show legends on modal.").addToggle(o=>o.setValue(t.showLegends).onChange(async n=>{t.showLegends=n,await this.plugin.saveData(this.plugin.settings)})),new l.Setting(e).setName("Color of button frame on focus").setDesc("Choice your favorite color.").addColorPicker(o=>o.setValue(t.focusColor).onChange(async n=>{t.focusColor=n,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(o=>{let n=()=>t.focusColor=d[s].focusColor;this.addResetButton(o,n)})}isDuplicateChars(e){return e.some((s,t)=>e.slice(t+1).includes(s))}onClickShortcutKeyEdit(e,s,t){e.inputEl.value="Press shortcut key",e.inputEl.addClass("class","bc-setting-shortcut-key-edit"),e.inputEl.focus();let o=this.plugin.settings[k.openBookmarksCaller][s],n=this.display.bind(this);e.inputEl.addEventListener("keyup",async r=>{this.plugin.settings[k.openBookmarksCaller][s]=r.key,e.setValue(r.key),await this.plugin.saveSettings(),e.inputEl.removeEventListener("blur",n),n()}),e.inputEl.addEventListener("blur",n),e.inputEl.addEventListener("blur",async()=>{this.isDuplicateChars([e.inputEl.value,...t])&&(this.plugin.settings[k.openBookmarksCaller][s]=o,await this.plugin.saveSettings(),new l.Notice(U,O)),he.includes(e.inputEl.value)&&(this.plugin.settings[k.openBookmarksCaller][s]=o,await this.plugin.saveSettings(),new l.Notice(ce,O))})}addResetButton(e,s,t=!0){e.addExtraButton(o=>o.setIcon("reset").setTooltip("Reset to default").onClick(async()=>{s(),await this.plugin.saveSettings(),this.updateStyleSheet(),t&&this.display()}))}};var B=require("obsidian");var W=require("obsidian"),u="bc-tmp-view",F=class extends W.ItemView{constructor(a){super(a)}getViewType(){return u}getDisplayText(){return""}async onOpen(){}async onClose(){}};var z="ArrowUp",q="ArrowDown",K="ArrowLeft",G="ArrowRight",pe=[{keys:"\u2191 | \u2193",description:"Move focus"},{keys:"\u2190 | \u2192",description:"Switch pages"},{keys:"back",description:"Back to parent group"},{keys:"Enter | Space",description:"Open focused item"},{keys:"chars",description:"Quickly open item"},{keys:"all",description:"Open all files in current group"}],f=i=>{var e;return i?`${(e=i.title)!=null?e:i.path}_${i.ctime}`:""},M=class extends B.Modal{constructor(e,s,t){super(e);this.corePlugins={bookmarks:void 0,fileExplorer:void 0,globalSearch:void 0,graph:void 0};this.chars=[];this.histories=[];this.buttonMap=new Map;this.pagePosition=0;this.focusPosition=0;this.groups=["."];this._currentLayerItems=[];this.settings=s,this.chars=[...this.modalSettings.characters],this.currentLayerItems=t.items,this.histories.push({items:this.currentLayerItems,pagePosition:0,focusPosition:0}),this.corePlugins.bookmarks=t,this.corePlugins.fileExplorer=p(this.app,"file-explorer"),this.corePlugins.globalSearch=p(this.app,"global-search"),this.corePlugins.graph=p(this.app,"graph")}set currentLayerItems(e){this._currentLayerItems=e}get currentLayerItems(){return this._currentLayerItems}get viewItems(){return this._currentLayerItems.slice(this.pagePosition*this.chars.length,this.chars.length+this.pagePosition*this.chars.length)}get modalSettings(){return this.settings.openBookmarksCaller}onOpen(){this.modalEl.addClasses(["bookmarks-caller-modal","bc-modal"]),this.generateHeader(this.contentEl),this.buttonsViewEl=this.contentEl.createDiv("bc-buttons-view"),this.generateButtons(this.buttonsViewEl),this.generateFooter(this.contentEl),this.eventListenerFunc=this.handlingKeyupEvent.bind(this),window.addEventListener("keyup",this.eventListenerFunc)}onClose(){window.removeEventListener("keyup",this.eventListenerFunc),this.contentEl.empty()}generateHeader(e){e.createDiv("bc-header",s=>{this.headerTextEl=s.createSpan(""),this.updateHeaderText()})}generateButtons(e,s=0,t=0){var o;e.empty(),this.focusPosition=t,this.pagePosition=s,this.viewItems.length||e.createSpan().setText("No items found in this group."),this.viewItems.forEach((n,r)=>{e.createDiv("bc-leaf-row",h=>{let c=h.createEl("button",{text:this.chars.at(r)});c.setAttr("tabIndex",-1),c.addClass("bc-shortcut-btn"),c.addEventListener("click",()=>this.clickItemButton(n,r));let g=h.createEl("button");g.addClass("bc-leaf-name-btn"),g.addEventListener("click",()=>this.clickItemButton(n,r)),(0,B.setIcon)(g,I(n));let v=E(this.app,n);g.createSpan("bc-leaf-name").setText(v||""),this.buttonMap.set(f(n),g)})}),(o=this.buttonMap.get(f(this.viewItems.at(t))))==null||o.focus(),this.updateHeaderText()}generateFooter(e){e.createDiv("bc-footer",s=>{this.modalSettings.showFooterButtons&&s.createDiv("bc-page-nav",t=>{let o=t.createEl("button");if((0,B.setIcon)(o,"undo-2"),o.createSpan("").setText("Back"),o.setAttr("tabIndex",-1),o.addClass("bc-nav-btn"),o.addEventListener("click",()=>this.backToParentLayer()),this.currentLayerItems.length>this.chars.length){let r=t.createEl("button",{text:"\u2190"});r.setAttr("tabIndex",-1),r.addClass("bc-nav-btn"),r.addEventListener("click",()=>this.keyupArrowKeys(K));let h=t.createEl("button",{text:"\u2192"});h.setAttr("tabIndex",-1),h.addClass("bc-nav-btn"),h.addEventListener("click",()=>this.keyupArrowKeys(G))}let n=t.createEl("button");(0,B.setIcon)(n,"square-stack"),n.createSpan("").setText("All"),n.setAttr("tabIndex",-1),n.addClass("bc-nav-btn"),n.addEventListener("click",()=>this.openAllFiles(this.currentLayerItems))}),this.modalSettings.showLegends&&pe.forEach(t=>{s.createDiv("bc-legend",o=>{let n=t.keys;n==="all"&&(n=this.modalSettings.allBtn),n==="back"&&(n=this.modalSettings.backBtn),n==="chars"&&(n=`${this.chars.slice(0,2).join(" | ")} | ... | ${this.chars.slice(-2).join(" | ")}`),o.createSpan("bc-keys").setText(n),o.createSpan("bc-description").setText(t.description)})})})}updateHeaderText(){let e=this.groups.length===1?`${this.groups.at(0)}/`:`.../${this.groups.at(-1)}/`;this.headerTextEl.setText(e)}async clickItemButton(e,s){switch(e.type){case"group":{this.openBookmarkOfGroup(e,s);break}case"file":{C(this.app,e),this.close();break}case"folder":{P(this.app,e,this.corePlugins.fileExplorer),this.close();break}case"search":{L(e,this.corePlugins.globalSearch),this.close();break}case"graph":{await x(this.app,e,this.corePlugins.bookmarks,this.corePlugins.graph),this.close();break}default:break}}openBookmarkOfGroup(e,s){let t=this.histories.at(-1);t.pagePosition=this.pagePosition,t.focusPosition=s,this.currentLayerItems=e.items||[],this.groups.push(`${e.title}`),this.histories.push({items:this.currentLayerItems,pagePosition:0,focusPosition:0}),this.generateButtons(this.buttonsViewEl)}handlingKeyupEvent(e){if(this.chars.includes(e.key)){this.keyupShortcutKeys(e.key),e.preventDefault();return}if([z,q,K,G].includes(e.key)){this.keyupArrowKeys(e.key),e.preventDefault();return}if(e.key===this.modalSettings.backBtn){this.backToParentLayer(),e.preventDefault();return}if(e.key===this.modalSettings.allBtn){this.openAllFiles(this.currentLayerItems),e.preventDefault();return}}keyupShortcutKeys(e){var o;let s=this.chars.indexOf(e),t=this.viewItems.at(s);(o=this.buttonMap.get(f(t)))==null||o.click()}keyupArrowKeys(e){switch(e){case z:this.focusPosition===0?(this.buttonMap.get(f(this.viewItems.at(-1))).focus(),this.focusPosition=this.viewItems.length-1):(this.buttonMap.get(f(this.viewItems[this.focusPosition-1])).focus(),this.focusPosition-=1);break;case q:this.focusPosition===this.viewItems.length-1?(this.buttonMap.get(f(this.viewItems.at(0))).focus(),this.focusPosition=0):(this.buttonMap.get(f(this.viewItems[this.focusPosition+1])).focus(),this.focusPosition+=1);break;case K:{let s=this.currentLayerItems.length/this.chars.length;if(Math.ceil(s)===1)break;this.pagePosition===0?this.pagePosition=this.currentLayerItems.length%this.chars.length===0?Math.floor(s)-1:Math.floor(s):this.pagePosition-=1,this.generateButtons(this.buttonsViewEl,this.pagePosition);break}case G:{let s=this.currentLayerItems.length/this.chars.length;if(Math.ceil(s)===1)break;let t=this.currentLayerItems.length%this.chars.length===0?s-1:Math.floor(s);this.pagePosition===t?this.pagePosition=0:this.pagePosition+=1,this.generateButtons(this.buttonsViewEl,this.pagePosition);break}default:break}}backToParentLayer(){if(this.histories.length>1){this.groups.pop(),this.histories.pop();let{items:e,pagePosition:s,focusPosition:t}=this.histories.at(-1);this.currentLayerItems=e,this.generateButtons(this.buttonsViewEl,s,t)}}async openAllFiles(e,s=!0){s&&await this.app.workspace.getLeaf(!0).setViewState({type:u});let t=this.modalSettings.recursivelyOpen;await S(this.app,e,t),s&&(this.app.workspace.detachLeavesOfType(u),this.close())}};var m=require("obsidian");var _={all:"Enter",back:"Backspace"},ue=[{keys:"\u2191 | \u2193",description:"Move focus"},{keys:"back",description:"Back to parent group"},{keys:"Enter",description:"Open focused item"},{keys:"all",description:"Open all files in current group"}],ge=i=>(a,e)=>i?e.ctime-a.ctime:a.ctime-e.ctime,y=class extends m.FuzzySuggestModal{constructor(e,s,t,o,n=[]){super(e);this.bookmarks=[];this.currentLayerItems=[];this.corePlugins={bookmarks:void 0,fileExplorer:void 0,globalSearch:void 0,graph:void 0};this.upperLayers=[];this.settings=s;let r=structuredClone(o),h=this.modalSettings.structureType===H.original?r:this.convertToFlatStructure(r),c=this.modalSettings.sortOrder;this.bookmarks=c===A.original?h:h.sort(ge(c===A.newer)),this.currentLayerItems=this.bookmarks,this.upperLayers=n,this.corePlugins.bookmarks=t,this.corePlugins.fileExplorer=p(this.app,"file-explorer"),this.corePlugins.globalSearch=p(this.app,"global-search"),this.corePlugins.graph=p(this.app,"graph"),this.setPlaceholder("Search bookmarks"),this.eventListenerFunc=this.handlingKeyupEvent.bind(this),window.addEventListener("keyup",this.eventListenerFunc),this.generateFooter(this.modalEl),this.modalEl.addClasses(["bookmarks-search-modal","bs-modal"])}get modalSettings(){return this.settings.searchBookmarks}onClose(){window.removeEventListener("keyup",this.eventListenerFunc)}getItems(){return this.currentLayerItems}getItemText(e){return E(this.app,e)}generateFooter(e){e.createDiv("bs-footer",s=>{if(this.modalSettings.showFooterButtons&&s.createDiv("bs-button",t=>{let o=t.createEl("button");(0,m.setIcon)(o,"undo-2"),o.createSpan("").setText("Back"),o.setAttr("tabIndex",-1),o.addClass("bs-btn"),o.addEventListener("click",()=>this.backToParentLayer());let n=t.createEl("button");(0,m.setIcon)(n,"square-stack"),n.createSpan("").setText("All"),n.setAttr("tabIndex",-1),n.addClass("bs-btn"),n.addEventListener("click",()=>this.openAllFiles(this.currentLayerItems))}),this.modalSettings.showLegends){let t=m.Platform.isMacOS||m.Platform.isIosApp?"\u21E7":"Shift + ";ue.forEach(o=>{s.createDiv("bs-legend",n=>{let r=o.keys;r==="all"&&(r=`${t}${_.all}`),r==="back"&&(r=`${t}${_.back}`),n.createSpan("bs-keys").setText(r),n.createSpan("bs-description").setText(o.description)})})}})}async onChooseItem(e){switch(e.type){case"group":{this.openBookmarkOfGroup(e);break}case"file":{C(this.app,e);break}case"folder":{P(this.app,e,this.corePlugins.fileExplorer);break}case"search":{L(e,this.corePlugins.globalSearch);break}case"graph":{await x(this.app,e,this.corePlugins.bookmarks,this.corePlugins.graph);break}default:break}}renderSuggestion(e,s){let t=e.item;return(0,m.setIcon)(s,I(t)),s.createSpan("",o=>o.setText(E(this.app,t))),s}openBookmarkOfGroup(e){if(this.corePlugins.bookmarks){let s=e.items||[],t=[...this.upperLayers,s];new y(this.app,this.settings,this.corePlugins.bookmarks,s,t).open()}}convertToFlatStructure(e){let s=[];return e.forEach(t=>{s.push(t),t.type==="group"&&s.push(...this.convertToFlatStructure(t.items||[]))}),s}handlingKeyupEvent(e){if(e.key===_.back&&e.shiftKey){this.backToParentLayer(),e.preventDefault();return}if(e.key===_.all&&e.shiftKey){this.openAllFiles(this.currentLayerItems),e.preventDefault();return}}backToParentLayer(){if(!(this.upperLayers.length<=1)&&this.corePlugins.bookmarks){this.upperLayers.pop();let e=this.upperLayers.at(-1)||[];new y(this.app,this.settings,this.corePlugins.bookmarks,e,this.upperLayers).open(),this.close()}}async openAllFiles(e,s=!0){s&&await this.app.workspace.getLeaf(!0).setViewState({type:u});let t=this.modalSettings.recursivelyOpen&&this.modalSettings.structureType==="original";await S(this.app,e,t),s&&(this.app.workspace.detachLeavesOfType(u),this.close())}};var j=require("obsidian"),w=class extends j.Modal{constructor(a){super(a)}onOpen(){this.modalEl.addClasses(["bookmarks-message-modal","bm-modal"]);let a=this.contentEl.createDiv("bm-contents"),e=a.createDiv("bm-content");e.createSpan().setText("This plugin needs bookmarks plugin, but bookmarks plugin is disabled."),e.createSpan().setText("You can enable bookmarks plugin under `Settings` \u2192 `Core plugins` \u2192 `Bookmarks`.");let s=a.createDiv("bm-content");s.createSpan().setText("Please check the following page for bookmarks.");let t=s.createEl("a"),o="https://help.obsidian.md/Plugins/Bookmarks";t.setText(o),t.setAttr("href",o)}onClose(){this.contentEl.empty()}};var R=class extends Q.Plugin{async onload(){await this.loadSettings(),this.registerView(u,e=>new F(e)),this.addRibbonIcon("bookmark","Open bookmarks caller",()=>this.openBookmarksCallerModal()),this.addRibbonIcon("bookmark-check","Search bookmarks",()=>this.openBookmarksSearcherModal()),this.addCommand({id:"open-bookmarks-caller",name:"Open bookmarks caller",callback:()=>this.openBookmarksCallerModal()}),this.addCommand({id:"search-bookmarks",name:"Search bookmarks",callback:()=>this.openBookmarksSearcherModal()}),this.settingTab=new D(this.app,this),this.addSettingTab(this.settingTab),this.settingTab.updateStyleSheet()}onunload(){this.settingTab.updateStyleSheet(!0),this.app.workspace.detachLeavesOfType(u)}async loadSettings(){this.settings=Object.assign({},d,await this.loadData()),this.migrateSettingValues()}async saveSettings(){await this.saveData(this.settings)}openBookmarksCallerModal(){let e=p(this.app,"bookmarks");e?new M(this.app,this.settings,e).open():new w(this.app).open()}openBookmarksSearcherModal(){let e=p(this.app,"bookmarks");if(e){let s=e.items;new y(this.app,this.settings,e,s,[s]).open()}else new w(this.app).open()}async migrateSettingValues(){let e=this.settings;typeof e.recursivelyOpen=="boolean"&&(this.settings.openBookmarksCaller.recursivelyOpen=e.recursivelyOpen,delete e.recursivelyOpen),typeof e.showFooterButtons=="boolean"&&(this.settings.openBookmarksCaller.showFooterButtons=e.showFooterButtons,delete e.showFooterButtons),typeof e.showLegends=="boolean"&&(this.settings.openBookmarksCaller.showLegends=e.showLegends,delete e.showLegends),typeof e.focusColor=="string"&&(this.settings.openBookmarksCaller.focusColor=e.focusColor,delete e.focusColor),typeof e.characters=="string"&&(this.settings.openBookmarksCaller.characters=e.characters,delete e.characters),typeof e.allBtn=="string"&&(this.settings.openBookmarksCaller.allBtn=e.allBtn,delete e.allBtn),typeof e.backBtn=="string"&&(this.settings.openBookmarksCaller.backBtn=e.backBtn,delete e.backBtn),await this.saveSettings()}};
