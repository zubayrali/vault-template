/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var v=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var D=(d,t)=>{for(var s in t)v(d,s,{get:t[s],enumerable:!0})},U=(d,t,s,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of P(t))!E.call(d,i)&&i!==s&&v(d,i,{get:()=>t[i],enumerable:!(o=k(t,i))||o.enumerable});return d};var R=d=>U(v({},"__esModule",{value:!0}),d);var O={};D(O,{default:()=>b});module.exports=R(O);var p=require("obsidian");var l=require("obsidian"),a={ribbonIcon:!0,ribbonCommandUsesCode:!0,executeTemplate:'code "{{vaultpath}}" "{{vaultpath}}/{{filepath}}"',openFile:!0,workspacePath:"{{vaultpath}}",useUrlInsiders:!1},m=class extends l.PluginSettingTab{constructor(t,s){super(t,s),this.plugin=s}display(){let{containerEl:t}=this;t.empty(),t.createEl("h3",{text:"General settings"}),new l.Setting(t).setName("Display Ribbon Icon").setDesc("Toggle this OFF if you want to hide the Ribbon Icon.").addToggle(n=>n.setValue(this.plugin.settings.ribbonIcon).onChange(e=>{this.plugin.settings.ribbonIcon=e,this.plugin.saveSettings(),this.plugin.refreshIconRibbon()})),new l.Setting(t).setName("Ribbon opens via `code` command").setDesc("Toggle this OFF if you'd prefer that the Ribbon Icon opens VSCode via URL.").addToggle(n=>n.setValue(this.plugin.settings.ribbonCommandUsesCode).onChange(e=>{this.plugin.settings.ribbonCommandUsesCode=e,this.plugin.saveSettings()})),t.createEl("h3",{text:"Open via `code` CLI settings"}),new l.Setting(t).setName("Template for executing the `code` command").setDesc('You can use the following variables: `{{vaultpath}}` (absolute), `{{filepath}}` (relative), `{{folderpath}}` (relative), `{{line}}` and `{{ch}}`. Note that on MacOS, a full path to the VSCode executable is required (generally "/usr/local/bin/code"). Example: `/usr/local/bin/code "{{vaultpath}}" "{{vaultpath}}/{{filepath}}"`').addText(n=>n.setPlaceholder(a.executeTemplate).setValue(this.plugin.settings.executeTemplate||a.executeTemplate).onChange(e=>{e=e.trim(),e===""&&(e=a.executeTemplate),this.plugin.settings.executeTemplate=e,this.plugin.saveData(this.plugin.settings)})),t.createEl("h3",{text:"Open via `vscode://` URL settings"});let o=t.createEl("p").createEl("em",{text:`\u26A0\uFE0F This setting is not recommended for Windows users due to
              UX issues caused by security enhancements in VSCode on Windows. More information: `});o.appendChild(createEl("a",{text:"Open in VSCode Readme",href:"https://github.com/NomarCub/obsidian-open-vscode/blob/master/README.md#caveats-regarding-the-url-command-for-windows-users"})),o.appendText("."),new l.Setting(t).setName("Open current file").setDesc("Open the current file rather than the root of the vault.").addToggle(n=>n.setValue(this.plugin.settings.openFile||a.openFile).onChange(e=>{this.plugin.settings.openFile=e,this.plugin.saveData(this.plugin.settings)}));let i=new l.Setting(t).setName("Path to VSCode Workspace").setDesc('Defaults to the {{vaultpath}} template variable. You can set this to an absolute path to a ".code-workspace" file if you prefer to use a Multi Root workspace file: ').addText(n=>n.setPlaceholder(a.workspacePath).setValue(this.plugin.settings.workspacePath||a.workspacePath).onChange(e=>{e=e.trim(),e===""&&(e=a.workspacePath),this.plugin.settings.workspacePath=e,this.plugin.saveData(this.plugin.settings)})),r="https://code.visualstudio.com/docs/editor/workspaces#_multiroot-workspaces";i.descEl.appendChild(createEl("a",{href:r,text:r})).appendText("."),new l.Setting(t).setName("Open VSCode using a `vscode-insiders://` URL").addToggle(n=>n.setValue(this.plugin.settings.useUrlInsiders).onChange(e=>{this.plugin.settings.useUrlInsiders=e,this.plugin.saveSettings()}))}};var I=require("child_process"),h=class h extends p.Plugin{constructor(){super(...arguments);this.DEV=!1;this.refreshIconRibbon=()=>{var s;(s=this.ribbonIcon)==null||s.remove(),this.settings.ribbonIcon&&(this.ribbonIcon=this.addRibbonIcon(h.iconId,"VSCode",()=>{let o=this.settings.ribbonCommandUsesCode?"openVSCode":"openVSCodeUrl";this[o]()}))}}async onload(){var o;console.log("Loading "+this.manifest.name+" plugin"),(0,p.addIcon)(h.iconId,h.iconSvgContent),await this.loadSettings(),this.refreshIconRibbon(),this.addSettingTab(new m(this.app,this)),this.addCommand({id:"open-vscode",name:"Open as Visual Studio Code workspace",callback:this.openVSCode.bind(this)}),this.addCommand({id:"open-vscode-via-url",name:"Open as Visual Studio Code workspace using a vscode:// URL",callback:this.openVSCodeUrl.bind(this)});let s=this.app.plugins.getPlugin("hot-reload");this.DEV=(o=s==null?void 0:s.enabledPlugins.has(this.manifest.id))!=null?o:!1,this.DEV&&(this.addCommand({id:"open-vscode-reload",name:"Reload the plugin in dev",callback:this.reload.bind(this)}),this.addCommand({id:"open-vscode-reset-settings",name:"Reset plugins settings to default in dev",callback:this.resetSettings.bind(this)}))}openVSCode(){var f,C,S,w,V,x;if(!(this.app.vault.adapter instanceof p.FileSystemAdapter))return;let{executeTemplate:s}=this.settings,o=this.app.vault.adapter.getBasePath(),i=this.app.workspace.getActiveFile(),r=(f=i==null?void 0:i.path)!=null?f:"",n=(S=(C=i==null?void 0:i.parent)==null?void 0:C.path)!=null?S:"",e=(w=this.app.workspace.getActiveViewOfType(p.MarkdownView))==null?void 0:w.editor.getCursor(),c=((V=e==null?void 0:e.line)!=null?V:0)+1,u=((x=e==null?void 0:e.ch)!=null?x:0)+1,g=s.trim()===""?a.executeTemplate:s;g=g.replaceAll("{{vaultpath}}",o).replaceAll("{{filepath}}",r).replaceAll("{{folderpath}}",n).replaceAll("{{line}}",c.toString()).replaceAll("{{ch}}",u.toString()),this.DEV&&console.log("[openVSCode]",{command:g}),(0,I.exec)(g,T=>{T&&console.error(`[openVSCode] exec error: ${T.message}`)})}openVSCodeUrl(){var u;if(!(this.app.vault.adapter instanceof p.FileSystemAdapter))return;let{openFile:s,useUrlInsiders:o}=this.settings,i=this.app.vault.adapter.getBasePath(),r=this.app.workspace.getActiveFile(),n=(u=r==null?void 0:r.path)!=null?u:"";this.DEV&&console.log("[open-vscode]",{settings:this.settings,path:i,filePath:n});let c=`${o?"vscode-insiders://":"vscode://"}file/${i}`;if(s){c+=`/${n}`;let g=this.settings.workspacePath.replaceAll("{{vaultpath}}",i);window.open(`vscode://file/${g}`),setTimeout(()=>{this.DEV&&console.log("[openVSCode]",{url:c}),window.open(c)},200)}else this.DEV&&console.log("[openVSCode]",{url:c}),window.open(c)}async loadSettings(){this.settings=Object.assign({},a,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async reload(){let s=this.manifest.id,o=this.app.plugins;await o.disablePlugin(s),await o.enablePlugin(s),console.log(`[${this.manifest.id}] reloaded`,this)}async resetSettings(){console.log(`[${this.manifest.id}]`,{old:this.settings,default:a}),this.settings=a,await this.saveData(this.settings)}};h.iconId="vscode-logo",h.iconSvgContent=`
<svg role="img" viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg">
    <title>Visual Studio Code</title>
    <path
        fill="currentColor"
        d="M23.15 2.587L18.21.21a1.494 1.494 0 0 0-1.705.29l-9.46 8.63-4.12-3.128a.999.999 0 0 0-1.276.057L.327 7.261A1 1 0 0 0 .326 8.74L3.899 12 .326 15.26a1 1 0 0 0 .001 1.479L1.65 17.94a.999.999 0 0 0 1.276.057l4.12-3.128 9.46 8.63a1.492 1.492 0 0 0 1.704.29l4.942-2.377A1.5 1.5 0 0 0 24 20.06V3.939a1.5 1.5 0 0 0-.85-1.352zm-5.146 14.861L10.826 12l7.178-5.448v10.896z"
    />
</svg>
`;var b=h;
